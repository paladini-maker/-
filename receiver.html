<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <title>Shaka Cast Receiver Minimal</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/shaka-player/4.3.6/shaka-player.compiled.js"></script>
    <script src="//www.gstatic.com/cast/sdk/libs/caf_receiver/v3/cast_receiver_framework.js"></script>
    
    <style>
        body { margin: 0; overflow: hidden; background: #000; }
        video { width: 100%; height: 100%; }
    </style>
</head>
<body>

    <video id="video" class="castMediaElement"></video>

    <script>
        async function init() {
            // Instancia básica de Cast Context
            const context = cast.framework.CastReceiverContext.getInstance();
            const playerManager = context.getPlayerManager();
            const video = document.getElementById('video');

            // Inicializar Shaka y el adaptador de Cast
            // Esto permite que Shaka intercepte las peticiones de carga del Sender
            const shakaPlayer = new shaka.Player(video);
            const castReceiver = new shaka.cast.CastReceiver(context, playerManager, shakaPlayer);

            // Configuración opcional para CC v2 (buffer conservador para poca RAM)
            shakaPlayer.configure({
                streaming: {
                    bufferingGoal: 10,
                    rebufferingGoal: 2
                }
            });

            // Iniciar el Receiver
            context.start();
            console.log('Receiver iniciado y esperando...');
        }

        init();
    </script>
</body>
</html>